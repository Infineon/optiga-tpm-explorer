<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>AWS IoT Embedded C Device SDK: MQTT Publish and Subscribe</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Embedded C Device SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">MQTT Publish and Subscribe </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A device can interact with AWS IoT using MQTT pub/sub alone. This mode is preferred if the device is extremely resource constrained and does not want to do any string or JSON parsing of Thing Shadow protocol. The sample_apps <a class="el" href="subscribe__publish__sample_8c.html" title="simple MQTT publish and subscribe on the same topic ">subscribe_publish_sample.c</a> is a good place to start.</p>
<p>Any time if you would like to just use the MQTT interface without shadow, include the <a class="el" href="aws__iot__mqtt__interface_8h.html" title="Interface definition for MQTT client. ">aws_iot_mqtt_interface.h</a> file . This file has all the APIs needed for a device to communicate with the AWS IoT Platform</p>
<h1><a class="anchor" id="connectionMqtt"></a>
Connection Management</h1>
<p><code><a class="el" href="aws__iot__mqtt__interface_8h.html#ad4dd895d98e1817f50ddff9c4d90a910" title="MQTT Connection Function. ">aws_iot_mqtt_connect()</a></code> </p>
<p><code><a class="el" href="aws__iot__mqtt__interface_8h.html#a43239bf4d3404ed6ab670867d38af9ba" title="Disconnect an MQTT Connection. ">aws_iot_mqtt_disconnect()</a></code> </p>
<h1><a class="anchor" id="publishMqtt"></a>
Publishing message</h1>
<p><code><a class="el" href="aws__iot__mqtt__interface_8h.html#a64add1a52267b107da64a64ed8e10c7d" title="Publish an MQTT message on a topic. ">aws_iot_mqtt_publish()</a></code> </p>
<h1><a class="anchor" id="subscribeMqtt"></a>
Subscribe to a topic filter</h1>
<p><code><a class="el" href="aws__iot__mqtt__interface_8h.html#a8a4b23693f45977cf0fb9c8d9c1c840f" title="Subscribe to an MQTT topic. ">aws_iot_mqtt_subscribe()</a></code> </p>
<p><code><a class="el" href="aws__iot__mqtt__interface_8h.html#a59cc6f1c79f2e21d7c0e0c459a2e7968" title="Unsubscribe to an MQTT topic. ">aws_iot_mqtt_unsubscribe()</a></code> </p>
<h1><a class="anchor" id="yieldMqtt"></a>
Yield(background MQTT tasks)</h1>
<p><code><a class="el" href="aws__iot__mqtt__interface_8h.html#aee7520d1eb7c96ac7e560044bbfb98dd" title="Yield to the MQTT client. ">aws_iot_mqtt_yield()</a></code> </p>
<p>Generally this function could be called in a separate thread and all the callbacks will be called from the context of this thread. Other threads can publish.</p>
<dl class="section note"><dt>Note</dt><dd>In a multi-threaded environment always acquire a lock before performing any operation on the MQTT library. This library is not thread safe.</dd></dl>
<h1><a class="anchor" id="KnownIssues"></a>
Known Issues</h1>
<ul>
<li>AWS IoT Platform does not currently support QoS2</li>
<li>The Publish of QoS 1 messages will be blocking and any message that is not PUBACK will be delivered to the callback if the topic was subscribed. This is not expected in the publish function and should happen only in the <a class="el" href="aws__iot__mqtt__interface_8h.html#aee7520d1eb7c96ac7e560044bbfb98dd" title="Yield to the MQTT client. ">aws_iot_mqtt_yield()</a>. This will be fixed in the future revisions. The same is true for SUBACK.</li>
<li>Retained flag of published message is not supported</li>
</ul>
<h1><a class="anchor" id="config"></a>
Configuration associated with MQTT layer</h1>
<p><a class="el" href="aws__iot__config_8h.html#a69d749cf372e4b6e0e5f202cdb645fee" title="Any time a message is sent out through the MQTT layer. The message is copied into this buffer anytime...">AWS_IOT_MQTT_TX_BUF_LEN</a></p>
<p><a class="el" href="aws__iot__config_8h.html#a56924a0ab46fb3d02329954fe478d99c" title="Any message that comes into the device should be less than this buffer size. If a received message is...">AWS_IOT_MQTT_RX_BUF_LEN</a></p>
<p><a class="el" href="aws__iot__config_8h.html#a80d534c1bf73c5c4aacd148cfcbef11b" title="Maximum number of topic filters the MQTT client can handle at any given time. This should be increase...">AWS_IOT_MQTT_NUM_SUBSCRIBE_HANDLERS</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
