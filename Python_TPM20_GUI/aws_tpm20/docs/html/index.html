<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>AWS IoT Embedded C Device SDK: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWS IoT Embedded C Device SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AWS IoT Embedded C Device SDK Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Makefiles in the samples folder had the executable bit set and could potentially delete all files of the host machine if executed as a bash script. More details could be found <a href="https://github.com/aws/aws-iot-device-sdk-embedded-C/issues/14">here</a>. Please upgrade to the latest version of the SDK.</p>
<h2>Overview</h2>
<p>The AWS IoT device SDK for embedded C is a collection of C source files which can be used in embedded applications to securely connect to the <a href="http://docs.aws.amazon.com/iot/latest/developerguide/what-is-aws-iot.html">AWS IoT platform</a>. It includes transport clients <b>MQTT</b>, <b>TLS</b> implementations and examples for their use. It also supports AWS IoT specific features such as <b>Thing Shadow</b>. It is distributed in source form and intended to be built into customer firmware along with application code, other libraries and RTOS. For additional information about porting the Device SDK for embedded C onto additional platforms please refer to the <a href="https://github.com/aws/aws-iot-device-sdk-embedded-c/blob/master/PortingGuide.md/">PortingGuide</a>.</p>
<h2>Features</h2>
<p>The Device SDK simplifies access to the Pub/Sub functionality of the AWS IoT broker via MQTT and provide APIs to interact with Thing Shadows. The SDK has been tested to work with the AWS IoT platform to ensure best interoperability of a device with the AWS IoT platform.</p>
<h3>MQTT Connection</h3>
<p>The Device SDK provides functionality to create and maintain a mutually authenticated TLS connection over which it runs MQTT. This connection is used for any further publish operations and allow for subscribing to MQTT topics which will call a configurable callback function when these topics are received.</p>
<h3>Thing Shadow</h3>
<p>The Device SDK implements the specific protocol for Thing Shadows to retrieve, update and delete Thing Shadows adhering to the protocol that is implemented to ensure correct versioning and support for client tokens. It abstracts the necessary MQTT topic subscriptions by automatically subscribing to and unsubscribing from the reserved topics as needed for each API call. Inbound state change requests are automatically signalled via a configurable callback.</p>
<h2>Design Goals of this SDK</h2>
<p>The embedded C SDK was specifically designed for resource constrained devices (running on micro-controllers and RTOS).</p>
<p>Primary aspects are:</p><ul>
<li>Flexibility in picking and choosing functionalities (reduce memory footprint)</li>
<li>Static memory only (no malloc’s)</li>
<li>Configurable resource usage(JSON tokens, MQTT subscription handlers, etc…)</li>
<li>Portability across RTOS due to use of wrapper functionality</li>
</ul>
<p>For more information on the Architecture of the SDK refer <a href="http://aws-iot-device-sdk-embedded-c-docs.s3-website-us-east-1.amazonaws.com/index.html">here</a></p>
<h2>How to get started ?</h2>
<p>Ensure you understand the AWS IoT platform and create the necessary certificates and policies. For more information on the AWS IoT platform please visit the <a href="http://docs.aws.amazon.com/iot/latest/developerguide/iot-security-identity.html">AWS IoT developer guide</a>.</p>
<p>In order to quickly get started with the AWS IoT platform, we have ported the SDK for POSIX type Operating Systems like Ubuntu, OS X and RHEL. The porting of the SDK happens at the TLS layer, and for the MQTT protocol. The SDK is configured for two TLS libraries and can be built out of the box with <em>GCC</em> using <em>make utility</em>. The tarballs can be downloaded from the below links.</p>
<ul>
<li><a href="https://s3.amazonaws.com/aws-iot-device-sdk-embedded-c/linux_mqtt_openssl-1.1.2.tar">OpenSSL</a></li>
<li><a href="https://s3.amazonaws.com/aws-iot-device-sdk-embedded-c/linux_mqtt_mbedtls-1.1.2.tar">mbedTLS from ARM</a></li>
</ul>
<h2>Installation</h2>
<p>This section explains the individual steps to retrieve the necessary files and be able to build your first application using the AWS IoT device SDK for embedded C.</p>
<p>Steps:</p>
<ul>
<li>Create a directory to hold your application e.g. (/home/&lt;user&gt;/aws_iot/my_app)</li>
<li>Change directory to this new directory</li>
<li>Download the SDK to device and place in the newly created directory</li>
<li>Expand the tarball (tar -xf &lt;tarball.tar&gt;). This will create 4 directories:<ul>
<li><code>aws_iot_src</code> - the AWS IoT SDK source files</li>
<li><code>sample_apps</code> - the sample applications</li>
<li><code>aws_mqtt_embedded_client_lib</code> - the aws MQTT client derived from <a href="http://www.eclipse.org/paho/clients/c/embedded/">Eclipse Paho</a> Embedded C client</li>
<li><code>certs</code> - TLS certificates directory</li>
</ul>
</li>
<li>Change directory to sample_apps. The following sample applications are included:<ul>
<li><code>subscribe_publish_sample</code> - a simple pub/sub MQTT example</li>
<li><code>shadow_sample</code> - a simple device shadow example using a connected window example</li>
<li><code>shadow_sample_console_echo</code> - a sample to work with the AWS IoT Console interactive guide</li>
</ul>
</li>
<li>For each sample:<ul>
<li>Explore the example. It connects to AWS IoT platform using MQTT and demonstrates few actions that can be performed by the SDK</li>
<li>Build the example using make. (''make'')</li>
<li>Place device identity cert and private key in locations referenced in the example (certs/). Alternatively, you can run the sample application with the ''-c'' flag to point to a specific certificate directory.</li>
<li>Download certificate authority CA file from <a href="https://www.symantec.com/content/en/us/enterprise/verisign/roots/VeriSign-Class%203-Public-Primary-Certification-Authority-G5.pem">Symantec</a> and place in location referenced in the example (certs/). Ensure the names of the cert files are the same as in the <code><a class="el" href="aws__iot__config_8h.html" title="AWS IoT specific configuration file. ">aws_iot_config.h</a></code> file</li>
<li>Run sample application (./subscribe_publish_sample or ./shadow_sample). The sample will print status messages to stdout.</li>
<li>More information on the examples could be found in the sample source file</li>
</ul>
</li>
</ul>
<p>Also, for a guided example on getting started with the Thing Shadow, visit the AWS IoT Console's <a href="https://console.aws.amazon.com/iot">Interactive Guide</a>.</p>
<h2>Porting to different platforms</h2>
<p>As Embedded devices run on different Real Time Operating Systems and TCP/IP stacks, it is one of the important design goals for the Device SDK to keep it portable. Please refer to the <a href="https://github.com/aws/aws-iot-device-sdk-embedded-C/blob/master/PortingGuide.md/">porting guide</a> to get more information on how to make this SDK run on your devices (i.e. micro-controllers).</p>
<h2>Resources</h2>
<p><a href="http://aws-iot-device-sdk-embedded-c-docs.s3-website-us-east-1.amazonaws.com/index.html">API Documentation</a></p>
<p><a href="http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/csprd02/mqtt-v3.1.1-csprd02.html">MQTT 3.1.1 Spec</a></p>
<h2>Support</h2>
<p>If you have any technical questions about AWS IoT Device SDK, use the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=210">AWS IoT forum</a>. For any other questions on AWS IoT, contact <a href="https://aws.amazon.com/contact-us/">AWS Support</a>.</p>
<h2>Sample APIs</h2>
<p>Connecting to the AWS IoT MQTT platform</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rc = aws_iot_mqtt_connect( &amp;connectParams ) ;</div>
</div><!-- fragment --><p>Subscribe to a topic</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;MQTTSubscribeParams subParams = MQTTSubscribeParamsDefault; </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;subParams.mHandler = MQTTcallbackHandler;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;subParams.qos = QOS_0;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;subParams.pTopic = &quot;sdkTest/sub&quot;;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;rc = aws_iot_mqtt_subscribe( &amp;subParams ) ;</div>
</div><!-- fragment --><p>Update Thing Shadow from a device</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;rc = aws_iot_shadow_update(&amp;mqttClient,</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AWS_IOT_MY_THING_NAME, </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;pJsonDocumentBuffer, </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;ShadowUpdateStatusCallback,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;pCallbackContext, </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;TIMEOUT_4SEC, </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;persistenSubscription);</div>
</div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
